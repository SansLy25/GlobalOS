# Отчет о работе на 23.05.2025

### Здесь собрана информация о проекте на текущий момент (также сроки и части работы), часть этой информации войдет в итоговую документацию

## Цели и задачи проекта

История программного обеспечения насчитывает уже более полувека, за это время накопилось немало интересного, в частности
операционных систем, но часто посмотреть ту или иную систему довольно проблематично, если устанавливать систему напрямую
то не получится пользоваться ей парралельно с основной, а если использовать десктопные эмуляторы (например QEMU) то
нахождение образа, его скачивание, настройка эмулятора занимает много времени. К тому же большинство систем старше 2000
год не требуют таких ресурсов.

Поэтому наш эмулятор позволяет не заморачиваться по поводу всех тонкостей, и открыть любую систему из каталога прямо на
сайте, в браузере, ничего не скачивая, буквально в 2 клика.

### Основные цели кратко

- Создать удобный легкий эмулятор в веб интерфейсе, способный эмулировать любую не очень требовательную x86 ОС
- Дать возможность погрузиться в историю ОС, а также легкие любительские интересные ОС
- Создать каталог образов систем с фильтрацией и предварительно настроить системы
- Создать интерфейс эмулятора, позволяющий управлять им и взаимодействовать с устройствами

### Возможная аудитория

- Разработчики операционных систем
- Интернет-гики
- Интересующиеся computer science
- Просто любознательные люди

Стоит отметить что по сути эмулятором может пользоваться любой, интерфейс user-friendly, а настраивать ничего не надо, в
аудитории же перечисленны группы которых проект может заинтересовать.

## Технологии

Сайт изначально не предполагает как такового бэкенда и БД, поэтому использованы только frontend технологии

- ### JavaScript
  Встраиваемый скриптовый язык программирования
- ### React
  Основной инструмент, библиотека для создания графических интерфейсов на JS, использует JSX (О нем далее) и SPA (Single
  App Application - позволяет переключать страницы практически мгновенно без дополнительных загрузок, за счет
  динамического рендеринга)
- ### NodeJS
  Среда для запуска JS вне браузера (на сервере), используется для Vite, основной JS код обрабатывается на стороне
  клиента (в браузере)
- ### Vite
  Локальный сервер разработки, запускается с помощью Node.js
- ### Tailwind
  CSS Фреймворк для упрощенного создания стилей с помощью CSS классов
- ### Docker, Docker-Compose (будет добавлен позже)
  Средства контейнеризации, для деплоя
- ### Nginx (будет добавлен позже)
  Основной production статический веб сервер, для деплоя
- ### Git, GitHub
  Контроль версий проекта

## Страницы

Страниц немного, но они все функциональные:

### Главная

Здесь находится краткий экскурс в функционал сайта, описание, переход в каталог и анимация

### Каталог

Каталог операционных систем доступных для запуска, позволяет фильтровать их по следующим параметрам:

- Категория (например Windows или Linux)
- Годы выхода
- Тип интерфейса (CLI или GUI)
- Название (поиск)

Каждая карточка операционной системы содержит информацию о ней.
После нахождения определенной системы пользователь может кликнуть на нее и перейти в нее на странице эмулятора

### Эмулятор

Страница эмулятора, отображает окно с ОС, позволяет управлять настраивать и управлять ей, настройка осуществляется с
помощью меню эмулятора, содержащий следующий функционал:

- Регулировка масштаба окна ОС по вертикали и горизонтали
- Отключение и включение устройств (мышь и звук)
- Настройка типа управления курсором (скрывать при клике на окно или при наведении)
- Управление состоянием (далее)
- Разворачивание окна ОС на полный экран
- Перезапуск системы

#### Состояние

Управление состоянием это функция которая дает возможность как бы сделать снимок текущего состояния системы (сохранить в
виде файла) это сохранит данных на диске, файлы, запущенные программы, данные в ОЗУ и вообще все текущее состояние ОС,
после чего файл можно загрузить и после перезахода на сайт, тем самым сохранив данные

Страница эмулятора транслирует нажатия с клавиатуры и движения мыши в эмулятор, а из эмулятора транслирует экран и звук

## Интерфейс

### Преимущества React

- Виртуальное DOM дерево позволяет обновлять страницу только в нужных местах, экономя ресурсы и ускоряя рендер
- Разделение логики на компоненты
- SPA (Single App Application) - загружает весь контент целиком при первой загрузке, из-за чего переключение между
  страницами становится бесшовным

### JSX

JSX - это расширение синтаксиса для JavaScript используемое в React, которое позволяет использовать html теги как
объекты языка, это очень удобно, мы можем выносить части html в переменные, динамически их изменять и использовать все
возможности объектов в JS

### Компоненты

В React интерфейс строится на основе компонентов (по сути функций, которые возвращают JSX (html)), это позволяет
выносить общие элементы страницы и управлять ими, например карточка системы это отдельный компонент, он принимает
название
и другие параметры и возвращает уже готовый блок html с нужными данными, мы можем использовать его в других
компонентах (например страница каталога), компонентами могут быть как страницы src/pages так и просто какие то
элементы UI, карточки, кнопки src/components

#### Очень простой пример компонента

```jsx
import {useState, useEffect} from 'react';
import {getUsers} from 'service'

function UserList() { // объявление компонента
    const [users, setUsers] = useState([]); //

    useEffect(() => {
        setUsers(getUsers())  // какая то абстрактная функция получения пользователей
    }, []);

    return (
        <ul> // начало jsx
            {users.map(user => (
                <li>{user.name}</li> // .map работает как в питоне, в итоге в ul будет массив пользователей
            ))}
        </ul>
    );
}

export default UserList;
```

### Tailwind

Проект имеет довольно сложный, динамический и современный UI, поэтому для ускорения верстки, для стилизации был
использован CSS фреймворк Tailwind

Taildind позволяет объявлять целые блоки стилей для html элементов через css классы, пример:

```html
<h1 class="bg-white rounded-xl shadow-md">Виртуализация это круто</h1>
```

В результате элемент будет иметь следующие стили:

```css
{
    background-color: rgb(255 255 255)
;
    border-radius: 0.75rem
;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)
;
}
```

Это довольно сильно ускоряет стилизацию

## Эмуляция

### Введение

Самой сложной задачей данного проекта было понять как вообще эмулировать другие ОС в браузере, кажется что это очень
сложно (так оно и есть), но основная задача сводится к тому, чтобы эмулировать работу x86 процессора, и уже на нем
запустить существующий образ системы, обычно OC сами предоставляют подобный функционал (например Virtual Machine
Platform в Windows), но в браузере подобного функционала нет, поэтому есть 2 возможны варианта эмуляции x86 процессора:

1. Эмулировать процессор и ОЗУ через JavaScript, это вариант очень медленный, тк JS интерпретируемый ЯП то он работает в
   десятки раз медленнее чем компилириуемые языки на которых эти ОС и писались (C например), так можно запустить только
   самые простые старые системы до 1980
2. Эмулирование процессора через Web Assembly (про него далее), то есть интерпретировать машинные команды x86 в код для
   Web
   Assembly, что позволяет сделать очень шуструю эмуляцию

Ввиду скорости был выбран более сложный второй вариант

### WebAssembly

WebAssembly (WASM) - это бинарный формат инструкций (аналог обычного Ассемблера), предназначенный для выполнения в
браузере, но
с близкой к нативной производительностью. Он поддерживается всеми основными
браузерами (Chrome, Firefox, Safari, Edge), WASM можно компилировать почти из любого ЯП, чаще всего для этого
используются C или Rust (потому что они как раз компилируемые и близкие к железу), чаще всего его применяют там где
нужна высокая производительность, с ним можно взаимодействовать через JS.

### v86

Написание своего эмулятора x86 32 битного процессора на WASM это невероятно сложная задача, к счастью существуют готовые
решения, в проекте используется [v86](https://github.com/copy/v86) c открытым кодом, он очень производителен и имеет
интерфейс (библиотеку) для JS

Что он делает:
v86 воссоздает поведение 32-битного x86-процессора (например, Intel 80386):

- Интерпретирует машинный код инструкций x86
- Эмулирует регистры (EAX, EBX, ESP и т. д.), прерывания (INT) и режимы работы (реальный, защищённый)
- Поддерживает MMX, SSE (частично) и математический сопроцессор (FPU)

Скорость такого процессора в браузере будет примерно ~10–50 MIPS (миллионов инструкций в секунду). Для сравнения:
реальный процессор ~50–100 MIPS, Что очень хороший результат для браузера и позволяет загружать OS вплоть до Windows XP

### BIOS

Биос важная часть для загрузки ОС, v86 рекомендует использовать SeaBIOS (BIOS по умолчанию для QEMU и KVM эмуляторов), в
проекте используется он
Также для работы видеоадаптера нужен VgaBIOS (используется рекомендованный v86, без названия)

## Сроки выполнения

- ### 19.04 - 28.04

  из явного:
    - Создана главная страница с описанием сайта
    - Создана страница каталога с различными динамическими фильтрами (год, тип интерфейса, категория) и поиском и
       самими карточками-системами
    - Создана базовая дополняемая навигация

  Из неявного:
    - Создана структура проекта
    - Создан репозиторий на github
    - Созданы переиспользуемые React UI компоненты которые будет использоваться и на странице эмулятора (SpinBox,
       Select, CheckBox section)
    - Конфигурирование системы с помощью конфига, можно легко добавлять новые системы

- ### 28.04 - 17.05
  На этом этапе был создан эмулятор управление которого возможно с помощью мыши и клавиатуры, в эмуляторе работает звук, перечень функций:

  - Управление масштабом эмулятора - размер экрана можно изменять в меню эмулятора
  - Перезапуск - перезапускает эмулятор, как будто это перезагрузка компьютера (сохраняет файлы)
  - Полноэкранный режим - возможность работать с системой на весь экран
  - Возможность отключить мышь и звук в меню
  - Управление типом курсора - есть 2 режима: "Скрывать при клике" (курсор скрывается при клике на окно эмулятора и возвращается после нажатия ESC) и " Скрывать при наведении" (курсор скрывается при наведении на окно эмулятора, но не гарантирует что виртуальный и реальный курсор будут синхронизированы)
  - Управление состоянием (доп функционал) - можно сохранить текущее состояние системы в файл, с помощью кнопки Скачать в меню, после чего состояние можно будет загрузить (кнопка Загрузить), сохранение состояния как бы делает снимок всей ОС на текущий момент, то есть сохраняет файлы, запущенные программы, процессы и ТД, загрузка происходит бесшовно, после нее можно продолжить работу ОС как будто вы и не выходили с сайта

   Помимо добавления функционала было проведено тестирование в десктопных версиях следующих браузерах: Chrome, Yandex, Edge, Firefox, (Safary не протестировал только ввиду отсутствия техники Apple)
   Также теперь каталог и эмулятор связаны напрямую, в него было добавлено 3 разнообразных системы для тестирования, которые можно использовать уже сейчас:


  - Windows 1.01 - простой графический интерфейс, тот же образ что был до этого (Работает отлично)
  - Linux (buildroot) - легкий дистрибутив  Linux с интерфейсом командной строки (Работает отлично)
  - KolibriOS - сложный графический интерфейс, много программ (Работает хорошо, имеются графические баги)
